# ìºì‹œë…¸íŠ¸ ë§ˆì¼“ ì£¼ë¬¸ ì„œë¹„ìŠ¤ ì‹¤í–‰ ê°€ì´ë“œ

## ëª©ì°¨
1. [í”„ë¡œì íŠ¸ ê°œìš”](#í”„ë¡œì íŠ¸-ê°œìš”)
2. [ì‚¬ì „ ìš”êµ¬ì‚¬í•­](#ì‚¬ì „-ìš”êµ¬ì‚¬í•­)
3. [í”„ë¡œì íŠ¸ êµ¬ì¡°](#í”„ë¡œì íŠ¸-êµ¬ì¡°)
4. [ë¹ ë¥¸ ì‹œì‘ ê°€ì´ë“œ](#ë¹ ë¥¸-ì‹œì‘-ê°€ì´ë“œ)
5. [ìƒì„¸ ì‹¤í–‰ ë°©ë²•](#ìƒì„¸-ì‹¤í–‰-ë°©ë²•)
6. [API í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ](#api-í…ŒìŠ¤íŠ¸-ê°€ì´ë“œ)
7. [íŠ¸ëŸ¬ë¸”ìŠˆíŒ…](#íŠ¸ëŸ¬ë¸”ìŠˆíŒ…)
8. [ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹…](#ëª¨ë‹ˆí„°ë§-ë°-ë¡œê¹…)

## í”„ë¡œì íŠ¸ ê°œìš”

ìºì‹œë…¸íŠ¸ ë§ˆì¼“ ì£¼ë¬¸ ì„œë¹„ìŠ¤ëŠ” ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ë¡œ êµ¬í˜„ëœ ì´ì»¤ë¨¸ìŠ¤ í”Œë«í¼ì…ë‹ˆë‹¤. 
ë‹¤ì–‘í•œ ê²°ì œ ìˆ˜ë‹¨(PG, ìºì‹œë…¸íŠ¸ í¬ì¸íŠ¸, BNPL, ë³µí•©ê²°ì œ)ì„ ì§€ì›í•˜ë©°, í—¥ì‚¬ê³ ë‚  ì•„í‚¤í…ì²˜ íŒ¨í„´ì„ ì ìš©í•˜ì—¬ 
ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ê³¼ ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ë¥¼ ëª…í™•íˆ ë¶„ë¦¬í–ˆìŠµë‹ˆë‹¤.

### ì£¼ìš” íŠ¹ì§•
- **ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜**: ì„œë¹„ìŠ¤ë³„ ë…ë¦½ì ì¸ ë°°í¬ì™€ í™•ì¥ ê°€ëŠ¥
- **í—¥ì‚¬ê³ ë‚  ì•„í‚¤í…ì²˜**: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì˜ ë…ë¦½ì„± ë³´ì¥
- **ë‹¤ì–‘í•œ ê²°ì œ ìˆ˜ë‹¨**: PG, í¬ì¸íŠ¸, BNPL, ì¿ í°, ë³µí•©ê²°ì œ ì§€ì›
- **ì´ë²¤íŠ¸ ê¸°ë°˜ í†µì‹ **: Kafkaë¥¼ í†µí•œ ë¹„ë™ê¸° í†µì‹ 
- **ì„œë¹„ìŠ¤ ê°„ ë™ê¸° í†µì‹ **: gRPCë¥¼ í†µí•œ ê³ ì„±ëŠ¥ í†µì‹ 

## ì‚¬ì „ ìš”êµ¬ì‚¬í•­

### í•„ìˆ˜ ì†Œí”„íŠ¸ì›¨ì–´
- **JDK 17** ì´ìƒ
- **Docker** 20.10.0 ì´ìƒ
- **Docker Compose** 2.0.0 ì´ìƒ
- **Git** 2.30.0 ì´ìƒ

### ê¶Œì¥ ê°œë°œ ë„êµ¬
- **IntelliJ IDEA** (Kotlin ì§€ì›)
- **DBeaver** ë˜ëŠ” **MySQL Workbench** (DB ê´€ë¦¬)
- **Postman** ë˜ëŠ” **curl** (API í…ŒìŠ¤íŠ¸)
- **Kafka UI** (ì„ íƒì‚¬í•­, Kafka ëª¨ë‹ˆí„°ë§)

### ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­
- **ë©”ëª¨ë¦¬**: ìµœì†Œ 8GB RAM (ê¶Œì¥ 16GB)
- **ë””ìŠ¤í¬**: ìµœì†Œ 10GB ì—¬ìœ  ê³µê°„
- **CPU**: 4ì½”ì–´ ì´ìƒ ê¶Œì¥

## í”„ë¡œì íŠ¸ êµ¬ì¡°

```
vincenzo-shopping-example/
â”œâ”€â”€ common/                   # ê³µí†µ ëª¨ë“ˆ (Kafka, gRPC Proto)
â”‚   â”œâ”€â”€ src/main/proto/      # gRPC Proto ì •ì˜
â”‚   â””â”€â”€ src/main/kotlin/     # ê³µí†µ í´ë˜ìŠ¤
â”œâ”€â”€ member-service/          # íšŒì› ì„œë¹„ìŠ¤
â”‚   â”œâ”€â”€ adapter/            # ì¸ë°”ìš´ë“œ/ì•„ì›ƒë°”ìš´ë“œ ì–´ëŒ‘í„°
â”‚   â”œâ”€â”€ application/        # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â””â”€â”€ domain/            # ë„ë©”ì¸ ëª¨ë¸
â”œâ”€â”€ product-service/         # ìƒí’ˆ ì„œë¹„ìŠ¤
â”œâ”€â”€ order-service/          # ì£¼ë¬¸ ì„œë¹„ìŠ¤
â”œâ”€â”€ payment-service/        # ê²°ì œ ì„œë¹„ìŠ¤
â”œâ”€â”€ docker-compose.yml      # Docker ì„¤ì •
â”œâ”€â”€ build.gradle.kts        # Gradle ë¹Œë“œ ì„¤ì •
â””â”€â”€ README.md
```

### ì„œë¹„ìŠ¤ë³„ í¬íŠ¸ ì •ë³´

#### HTTP REST API í¬íŠ¸
- **Member Service**: 8081
- **Product Service**: 8082
- **Order Service**: 8083
- **Payment Service**: 8084

#### gRPC í¬íŠ¸
- **Member Service**: 9090
- **Product Service**: 9091
- **Order Service**: 9094
- **Payment Service**: 9093

#### ì¸í”„ë¼ í¬íŠ¸
- **MySQL**: 3306
- **Kafka**: 9092
- **Zookeeper**: 2181

## ë¹ ë¥¸ ì‹œì‘ ê°€ì´ë“œ

### 1. í”„ë¡œì íŠ¸ í´ë¡ 
```bash
git clone https://github.com/vincenzo-dev-82/vincenzo-shopping-example.git
cd vincenzo-shopping-example
```

### 2. ì¸í”„ë¼ ì‹¤í–‰
```bash
# MySQLê³¼ Kafka ì»¨í…Œì´ë„ˆ ì‹¤í–‰
docker-compose up -d

# ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
docker-compose ps

# ë¡œê·¸ í™•ì¸ (ë¬¸ì œ ë°œìƒ ì‹œ)
docker-compose logs -f
```

### 3. í”„ë¡œì íŠ¸ ë¹Œë“œ
```bash
# ì „ì²´ í”„ë¡œì íŠ¸ ë¹Œë“œ
./gradlew clean build

# í…ŒìŠ¤íŠ¸ ì œì™¸í•˜ê³  ë¹Œë“œ (ë¹ ë¥¸ ë¹Œë“œ)
./gradlew clean build -x test
```

### 4. ì„œë¹„ìŠ¤ ì‹¤í–‰ (ê°ê° ë‹¤ë¥¸ í„°ë¯¸ë„ì—ì„œ)
```bash
# Member Service
./gradlew :member-service:bootRun

# Product Service  
./gradlew :product-service:bootRun

# Order Service
./gradlew :order-service:bootRun

# Payment Service
./gradlew :payment-service:bootRun
```

### 5. í—¬ìŠ¤ ì²´í¬
```bash
# ê° ì„œë¹„ìŠ¤ í—¬ìŠ¤ ì²´í¬
curl http://localhost:8081/api/members/hello
curl http://localhost:8082/api/products/hello
curl http://localhost:8083/api/orders/hello
curl http://localhost:8084/api/payments/hello
```

## ìƒì„¸ ì‹¤í–‰ ë°©ë²•

### Dockerë¥¼ ì‚¬ìš©í•œ ì „ì²´ ì„œë¹„ìŠ¤ ì‹¤í–‰

1. **Dockerfile ë¹Œë“œ** (ê° ì„œë¹„ìŠ¤ë³„)
```bash
# í”„ë¡œì íŠ¸ ë£¨íŠ¸ì—ì„œ
docker build -f member-service/Dockerfile -t vincenzo/member-service:latest .
docker build -f product-service/Dockerfile -t vincenzo/product-service:latest .
docker build -f order-service/Dockerfile -t vincenzo/order-service:latest .
docker build -f payment-service/Dockerfile -t vincenzo/payment-service:latest .
```

2. **docker-composeë¡œ ì „ì²´ ì‹¤í–‰**
```bash
# ì¸í”„ë¼ + ì• í”Œë¦¬ì¼€ì´ì…˜ ëª¨ë‘ ì‹¤í–‰
docker-compose -f docker-compose.yml -f docker-compose.app.yml up -d
```

### ê°œë°œ í™˜ê²½ì—ì„œ ê°œë³„ ì‹¤í–‰

1. **ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”**
```bash
# MySQL ì ‘ì†
docker exec -it shopping-mysql mysql -uroot -proot

# ë°ì´í„°ë² ì´ìŠ¤ í™•ì¸
USE shop;
SHOW TABLES;
```

2. **í™˜ê²½ë³€ìˆ˜ ì„¤ì •** (ì„ íƒì‚¬í•­)
```bash
export SPRING_PROFILES_ACTIVE=local
export DB_HOST=localhost
export KAFKA_BOOTSTRAP_SERVERS=localhost:9092
```

3. **IDEì—ì„œ ì‹¤í–‰**
- IntelliJ IDEAì—ì„œ ê° ì„œë¹„ìŠ¤ì˜ `*ServiceApplication.kt` íŒŒì¼ ì‹¤í–‰
- VM options: `-Xmx1g -Xms512m`
- Active profiles: `local`

## API í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ

### 1. íšŒì› ìƒì„±
```bash
curl -X POST http://localhost:8081/api/members \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "name": "í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì",
    "phoneNumber": "010-1234-5678"
  }'
```

### 2. ìƒí’ˆ ì¡°íšŒ
```bash
# ì „ì²´ ìƒí’ˆ ëª©ë¡
curl http://localhost:8082/api/products

# íŠ¹ì • ìƒí’ˆ ì¡°íšŒ
curl http://localhost:8082/api/products/1
```

### 3. ì£¼ë¬¸ ìƒì„± (ë‹¨ì¼ ê²°ì œ)
```bash
curl -X POST http://localhost:8083/api/orders \
  -H "Content-Type: application/json" \
  -d '{
    "memberId": 1,
    "items": [
      {
        "productId": 1,
        "quantity": 2
      }
    ],
    "paymentMethod": "PG_KPN"
  }'
```

### 4. ì£¼ë¬¸ ìƒì„± (ë³µí•© ê²°ì œ)
```bash
curl -X POST http://localhost:8083/api/orders \
  -H "Content-Type: application/json" \
  -d '{
    "memberId": 1,
    "items": [
      {
        "productId": 2,
        "quantity": 1
      }
    ],
    "paymentMethod": "COMPOSITE"
  }'
```

### 5. ê²°ì œ ë‚´ì—­ ì¡°íšŒ
```bash
# ì£¼ë¬¸ IDë¡œ ê²°ì œ ì¡°íšŒ
curl http://localhost:8084/api/payments/order/1001
```

## íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### 1. Docker ê´€ë ¨ ë¬¸ì œ

#### MySQL ì—°ê²° ì‹¤íŒ¨
```bash
# ì»¨í…Œì´ë„ˆ ë¡œê·¸ í™•ì¸
docker logs shopping-mysql

# ë„¤íŠ¸ì›Œí¬ í™•ì¸
docker network ls
docker network inspect vincenzo-shopping-example_default

# ì¬ì‹œì‘
docker-compose restart mysql
```

#### Kafka ì—°ê²° ì‹¤íŒ¨
```bash
# Kafka ìƒíƒœ í™•ì¸
docker exec -it shopping-kafka kafka-topics --list --bootstrap-server localhost:9092

# í† í”½ ìˆ˜ë™ ìƒì„±
docker exec -it shopping-kafka kafka-topics --create \
  --topic order-events \
  --bootstrap-server localhost:9092 \
  --partitions 3 \
  --replication-factor 1
```

### 2. ì• í”Œë¦¬ì¼€ì´ì…˜ ë¬¸ì œ

#### í¬íŠ¸ ì¶©ëŒ
```bash
# ì‚¬ìš© ì¤‘ì¸ í¬íŠ¸ í™•ì¸
lsof -i :8081
netstat -an | grep 8081

# í¬íŠ¸ ë³€ê²½ (application.yml)
server:
  port: 8085  # ë³€ê²½ëœ í¬íŠ¸
```

#### ë©”ëª¨ë¦¬ ë¶€ì¡±
```bash
# JVM í™ ë©”ëª¨ë¦¬ ì¦ê°€
export JAVA_OPTS="-Xmx2g -Xms1g"
./gradlew :order-service:bootRun
```

#### gRPC í†µì‹  ì‹¤íŒ¨
```bash
# gRPC ë¡œê·¸ ë ˆë²¨ ìƒì„¸ ì„¤ì •
logging:
  level:
    io.grpc: DEBUG
    net.devh: DEBUG
```

### 3. ë¹Œë“œ ë¬¸ì œ

#### Gradle ë¹Œë“œ ì‹¤íŒ¨
```bash
# Gradle ìºì‹œ ì‚­ì œ
./gradlew clean
rm -rf ~/.gradle/caches/

# ì˜ì¡´ì„± ìƒˆë¡œê³ ì¹¨
./gradlew build --refresh-dependencies
```

#### Proto íŒŒì¼ ì»´íŒŒì¼ ì‹¤íŒ¨
```bash
# Proto íŒŒì¼ ìˆ˜ë™ ì»´íŒŒì¼
./gradlew :common:generateProto
```

## ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹…

### 1. ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸ í™•ì¸

#### íŒŒì¼ ë¡œê·¸
```bash
# ë¡œê·¸ íŒŒì¼ ìœ„ì¹˜
tail -f logs/member-service.log
tail -f logs/order-service.log
```

#### ì‹¤ì‹œê°„ ë¡œê·¸
```bash
# Docker ë¡œê·¸
docker logs -f vincenzo-member-service

# Gradle ì‹¤í–‰ ì‹œ
./gradlew :order-service:bootRun | tee order.log
```

### 2. ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë‹ˆí„°ë§

```sql
-- í™œì„± ì—°ê²° í™•ì¸
SHOW PROCESSLIST;

-- í…Œì´ë¸” ìƒíƒœ í™•ì¸
SHOW TABLE STATUS FROM shop;

-- ìŠ¬ë¡œìš° ì¿¼ë¦¬ í™•ì¸
SHOW VARIABLES LIKE 'slow_query_log%';
```

### 3. Kafka ëª¨ë‹ˆí„°ë§

```bash
# í† í”½ ëª©ë¡ í™•ì¸
docker exec -it shopping-kafka kafka-topics --list \
  --bootstrap-server localhost:9092

# ì»¨ìŠˆë¨¸ ê·¸ë£¹ í™•ì¸
docker exec -it shopping-kafka kafka-consumer-groups --list \
  --bootstrap-server localhost:9092

# ë©”ì‹œì§€ í™•ì¸
docker exec -it shopping-kafka kafka-console-consumer \
  --topic order-events \
  --from-beginning \
  --bootstrap-server localhost:9092
```

### 4. ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§

#### JVM ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰
```bash
# jstatì„ ì‚¬ìš©í•œ GC ëª¨ë‹ˆí„°ë§
jstat -gc <PID> 1000

# jmapì„ ì‚¬ìš©í•œ í™ ë¤í”„
jmap -dump:format=b,file=heapdump.hprof <PID>
```

#### API ì‘ë‹µ ì‹œê°„ ì¸¡ì •
```bash
# curlì„ ì‚¬ìš©í•œ ì‘ë‹µ ì‹œê°„ ì¸¡ì •
curl -w "@curl-format.txt" -o /dev/null -s http://localhost:8083/api/orders/hello

# curl-format.txt ë‚´ìš©
time_namelookup:  %{time_namelookup}\n
time_connect:  %{time_connect}\n
time_appconnect:  %{time_appconnect}\n
time_pretransfer:  %{time_pretransfer}\n
time_redirect:  %{time_redirect}\n
time_starttransfer:  %{time_starttransfer}\n
time_total:  %{time_total}\n
```

## ì¶”ê°€ íŒ

### 1. ê°œë°œ íš¨ìœ¨ì„± í–¥ìƒ
- Spring Boot DevTools ì‚¬ìš©ìœ¼ë¡œ hot reload í™œì„±í™”
- LiveReload ë¸Œë¼ìš°ì € í™•ì¥ í”„ë¡œê·¸ë¨ ì„¤ì¹˜
- IntelliJ IDEAì˜ "Build project automatically" ì˜µì…˜ í™œì„±í™”

### 2. ë””ë²„ê¹… íŒ
- ê° ì„œë¹„ìŠ¤ë³„ë¡œ ë‹¤ë¥¸ ë””ë²„ê·¸ í¬íŠ¸ ì„¤ì • (5005, 5006, 5007, 5008)
- ì¡°ê±´ë¶€ ë¸Œë ˆì´í¬í¬ì¸íŠ¸ í™œìš©
- ë¡œê·¸ ë ˆë²¨ì„ DEBUGë¡œ ì„¤ì •í•˜ì—¬ ìƒì„¸ ì •ë³´ í™•ì¸

### 3. í…ŒìŠ¤íŠ¸ ë°ì´í„° ê´€ë¦¬
- `src/test/resources/data.sql`ì— í…ŒìŠ¤íŠ¸ ë°ì´í„° ì •ì˜
- í”„ë¡œíŒŒì¼ë³„ ë‹¤ë¥¸ ë°ì´í„° ì„¸íŠ¸ ê´€ë¦¬
- Testcontainers ì‚¬ìš©ìœ¼ë¡œ ê²©ë¦¬ëœ í…ŒìŠ¤íŠ¸ í™˜ê²½ êµ¬ì¶•

## ë¬¸ì˜ ë° ì§€ì›

í”„ë¡œì íŠ¸ ì‹¤í–‰ ì¤‘ ë¬¸ì œê°€ ë°œìƒí•˜ë©´:
1. GitHub Issuesì— ë¬¸ì œ ë“±ë¡
2. ë¡œê·¸ íŒŒì¼ê³¼ í•¨ê»˜ ìƒì„¸í•œ ì—ëŸ¬ ë©”ì‹œì§€ ì²¨ë¶€
3. ì‹¤í–‰ í™˜ê²½ ì •ë³´ (OS, Java ë²„ì „, Docker ë²„ì „ ë“±) í¬í•¨

---

Happy Coding! ğŸš€
